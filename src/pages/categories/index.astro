---
import Button from '@/components/Button.astro'
import type { CategoryHierarchy } from 'src/types'
import PageLayout from '@/layouts/BaseLayout.astro'
import { getAllPosts, getUniqueCategoriesWithCount } from '@/utils'
import { getCategoriesGroupByName } from 'src/utils/post'
import CategoriesView from 'src/components/CategoriesView'

const allPosts = await getAllPosts()
const allCategories = getUniqueCategoriesWithCount(allPosts)
const allCategoriesHierarchy = getCategoriesGroupByName(allPosts) as CategoryHierarchy[]

const meta = {
	description: "A list of all the topics I've written about in my posts",
	title: 'All Categories'
}

// Default to tree view
const defaultViewMode = 'tree'
---

<PageLayout meta={meta}>
	<div class='w-full'>
		<Button title='Back' href='/blog' style='button'>
			<svg
				xmlns='http://www.w3.org/2000/svg'
				width='14'
				height='14'
				viewBox='0 0 24 24'
				slot='icon-before'
			>
				<path
					fill='currentColor'
					d='m6.921 12.5l5.792 5.792L12 19l-7-7l7-7l.713.708L6.921 11.5H19v1z'
				>
				</path>
			</svg>
		</Button>
		<CategoriesView
			client:load
			allCategories={allCategories}
			allCategoriesHierarchy={allCategoriesHierarchy}
			defaultViewMode={defaultViewMode}
		/>
	</div>
</PageLayout>
